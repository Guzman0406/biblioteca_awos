{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 20, "column": 0}, "map": {"version":3,"sources":["file:///app/src/lib/db.ts"],"sourcesContent":["import { Pool } from 'pg';\r\n\r\nconst pool = new Pool({\r\n    host: process.env.DB_HOST || 'localhost',\r\n    port: parseInt(process.env.DB_PORT || '5434'),\r\n    user: process.env.DB_USER || 'biblioteca_admin',\r\n    password: process.env.DB_PASSWORD,\r\n    database: process.env.DB_NAME || 'biblioteca',\r\n});\r\n\r\nexport default pool;\r\n"],"names":[],"mappings":";;;;AAAA;;;;;;AAEA,MAAM,OAAO,IAAI,qJAAI,CAAC;IAClB,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,MAAM,SAAS,QAAQ,GAAG,CAAC,OAAO,IAAI;IACtC,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,UAAU,QAAQ,GAAG,CAAC,WAAW;IACjC,UAAU,QAAQ,GAAG,CAAC,OAAO,IAAI;AACrC;uCAEe"}},
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":["turbopack:///[next]/internal/font/google/space_mono_dab2c321.module.css [app-rsc] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"className\": \"space_mono_dab2c321-module__uqwqsq__className\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA","ignoreList":[0]}},
    {"offset": {"line": 49, "column": 0}, "map": {"version":3,"sources":["turbopack:///[next]/internal/font/google/space_mono_dab2c321.js"],"sourcesContent":["import cssModule from \"@vercel/turbopack-next/internal/font/google/cssmodule.module.css?{%22path%22:%22page.tsx%22,%22import%22:%22Space_Mono%22,%22arguments%22:[{%22weight%22:[%22400%22,%22700%22],%22subsets%22:[%22latin%22],%22display%22:%22swap%22}],%22variableName%22:%22spaceMono%22}\";\nconst fontData = {\n    className: cssModule.className,\n    style: {\n        fontFamily: \"'Space Mono', 'Space Mono Fallback'\",\n        fontStyle: \"normal\",\n\n    },\n};\n\nif (cssModule.variable != null) {\n    fontData.variable = cssModule.variable;\n}\n\nexport default fontData;\n"],"names":[],"mappings":";;;;AAAA;;AACA,MAAM,WAAW;IACb,WAAW,qKAAS,CAAC,SAAS;IAC9B,OAAO;QACH,YAAY;QACZ,WAAW;IAEf;AACJ;AAEA,IAAI,qKAAS,CAAC,QAAQ,IAAI,MAAM;IAC5B,SAAS,QAAQ,GAAG,qKAAS,CAAC,QAAQ;AAC1C;uCAEe","ignoreList":[0]}},
    {"offset": {"line": 72, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/page.tsx"],"sourcesContent":["import pool from '@/lib/db';\r\nimport Link from 'next/link';\r\nimport { Space_Mono } from 'next/font/google';\r\n\r\nconst spaceMono = Space_Mono({\r\n  weight: ['400', '700'],\r\n  subsets: ['latin'],\r\n  display: 'swap',\r\n});\r\n\r\nconst COLORS = {\r\n  bg: '#101015',\r\n  text: '#F1F0E1',\r\n  accent: '#506385',\r\n  cardBg: '#16161c',\r\n};\r\n\r\nasync function getSummaryData() {\r\n  const client = await pool.connect();\r\n  try {\r\n    const fines = await client.query('SELECT SUM(deuda_pendiente) as total FROM vw_resumen_multas');\r\n    const overdue = await client.query('SELECT COUNT(*) as total FROM vw_prestamos_vencidos');\r\n    const topBook = await client.query('SELECT titulo, total_prestamos FROM vw_libros_mas_prestados LIMIT 1');\r\n    const health = await client.query('SELECT AVG(porcentaje_ocupacion) as score FROM vw_salud_inventario');\r\n    const recentMember = await client.query('SELECT COUNT(*) as total FROM vw_actividad_socios');\r\n\r\n    const score = parseFloat(health.rows[0]?.score || '0');\r\n    const inventoryStatus = score > 80 ? 'CRÍTICO' : (score > 50 ? 'ADVERTENCIA' : 'ÓPTIMO');\r\n\r\n    return {\r\n      totalFines: parseFloat(fines.rows[0]?.total || '0'),\r\n      overdueLoans: parseInt(overdue.rows[0]?.total || '0'),\r\n      mostPopular: topBook.rows[0],\r\n      inventoryStatus: inventoryStatus,\r\n      inventoryScore: score,\r\n      memberCount: parseInt(recentMember.rows[0]?.total || '0'),\r\n    };\r\n  } finally {\r\n    client.release();\r\n  }\r\n}\r\n\r\nconst ProgressBar = ({ value }: { value: number }) => (\r\n  <div className=\"w-full h-1 bg-[#2a2a35] mt-4 overflow-hidden\">\r\n    <div\r\n      className=\"h-full\"\r\n      style={{\r\n        width: `${Math.min(value, 100)}%`,\r\n        backgroundColor: COLORS.text \r\n      }}\r\n    />\r\n  </div>\r\n);\r\n\r\nconst ViewCard = ({ title, kpiLabel, kpiValue, link, children }: { title: string, kpiLabel: string, kpiValue: string | number | React.ReactNode, link: string, children?: React.ReactNode }) => (\r\n  <Link href={link} className=\"group block relative p-6 bg-[#101015] border border-[#506385]/30 hover:border-[#506385] transition-all duration-300\">\r\n    <div className=\"absolute top-0 right-0 p-2 opacity-50 group-hover:opacity-100 transition-opacity\">\r\n      <svg width=\"10\" height=\"10\" viewBox=\"0 0 10 10\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n        <path d=\"M0 0L10 0L10 10\" stroke=\"#F1F0E1\" strokeWidth=\"1\" />\r\n      </svg>\r\n    </div>\r\n\r\n    <div className=\"flex flex-col h-full justify-between\">\r\n      <div>\r\n        <h2 className=\"text-xs uppercase tracking-[0.2em] mb-6 opacity-60\" style={{ color: COLORS.text }}>{title}</h2>\r\n\r\n        <div className=\"space-y-1\">\r\n          <div className=\"text-[10px] uppercase tracking-widest opacity-40\" style={{ color: COLORS.text }}>{kpiLabel}</div>\r\n          <div className=\"text-3xl font-bold tracking-tighter\" style={{ color: COLORS.text }}>{kpiValue}</div>\r\n        </div>\r\n      </div>\r\n\r\n      {children && (\r\n        <div className=\"mt-8 pt-4 border-t border-[#506385]/20\">\r\n          {children}\r\n        </div>\r\n      )}\r\n    </div>\r\n  </Link>\r\n);\r\n\r\nexport default async function Dashboard() {\r\n  const data = await getSummaryData();\r\n\r\n  return (\r\n    <main className={`min-h-screen p-6 md:p-12 flex flex-col ${spaceMono.className}`} style={{ backgroundColor: COLORS.bg, color: COLORS.text }}>\r\n\r\n      <div className=\"max-w-7xl w-full mx-auto\">\r\n        <header className=\"mb-20 flex flex-col md:flex-row justify-between items-end border-b pb-6\" style={{ borderColor: COLORS.accent }}>\r\n          <div>\r\n            <div className=\"text-[10px] uppercase tracking-[0.3em] mb-2 opacity-60\">Sistema de Gestión</div>\r\n            <h1 className=\"text-5xl md:text-6xl uppercase tracking-tighter font-bold\">\r\n              Panel Principal\r\n            </h1>\r\n          </div>\r\n          <div className=\"mt-6 md:mt-0 text-right\">\r\n            <div className=\"text-xs opacity-50 tracking-widest\">ESTADO DEL SISTEMA</div>\r\n            <div className=\"text-sm font-bold text-[#506385]\">EN LÍNEA</div>\r\n          </div>\r\n        </header>\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n\r\n          <ViewCard\r\n            title=\"Inventario\"\r\n            kpiLabel=\"Índice de Salud\"\r\n            kpiValue={`${data.inventoryScore.toFixed(0)}%`}\r\n            link=\"/reports/inventory\"\r\n          >\r\n            <div className=\"flex justify-between text-xs mb-1 opacity-70\">\r\n              <span className=\"uppercase tracking-wider\">Estado</span>\r\n              <span>{data.inventoryStatus}</span>\r\n            </div>\r\n            <ProgressBar value={data.inventoryScore} />\r\n          </ViewCard>\r\n\r\n          <ViewCard\r\n            title=\"Tendencias\"\r\n            kpiLabel=\"Más Solicitado\"\r\n            kpiValue={\r\n              <span className=\"text-xl line-clamp-2 leading-tight normal-case\">\r\n                {data.mostPopular?.titulo || \"N/A\"}\r\n              </span>\r\n            }\r\n            link=\"/reports/popular-books\"\r\n          >\r\n            <div className=\"flex items-center justify-between text-xs mt-1\">\r\n              <span className=\"uppercase tracking-wider opacity-60\">Préstamos Totales</span>\r\n              <span className=\"font-bold\">{data.mostPopular?.total_prestamos || 0}</span>\r\n            </div>\r\n          </ViewCard>\r\n\r\n          <ViewCard\r\n            title=\"Control de Préstamos\"\r\n            kpiLabel=\"Incidencias Activas\"\r\n            kpiValue={data.overdueLoans}\r\n            link=\"/reports/overdue\"\r\n          >\r\n            <div className=\"flex justify-between items-center mt-2\">\r\n              <div className=\"flex gap-1\">\r\n                {[1, 2, 3, 4, 5].map(i => (\r\n                  <div key={i} className={`w-1 h-3 ${i <= Math.min(data.overdueLoans, 5) ? 'bg-[#F1F0E1]' : 'bg-[#506385]/30'}`}></div>\r\n                ))}\r\n              </div>\r\n              <span className=\"text-[10px] uppercase tracking-wider opacity-60\">\r\n                {data.overdueLoans > 0 ? \"ATENCIÓN REQUERIDA\" : \"NORMAL\"}\r\n              </span>\r\n            </div>\r\n          </ViewCard>\r\n\r\n          <ViewCard\r\n            title=\"Finanzas\"\r\n            kpiLabel=\"Cartera Pendiente\"\r\n            kpiValue={`$${data.totalFines.toFixed(2)}`}\r\n            link=\"/reports/fines\"\r\n          >\r\n            <div className=\"w-full bg-[#506385]/10 p-2 mt-1 flex items-center justify-between border border-[#506385]/20\">\r\n              <span className=\"text-[10px] uppercase tracking-widest opacity-60\">Estado</span>\r\n              <span className=\"text-[10px] font-bold tracking-widest\" style={{ color: COLORS.accent }}>ACTIVO</span>\r\n            </div>\r\n          </ViewCard>\r\n\r\n          <ViewCard\r\n            title=\"Comunidad\"\r\n            kpiLabel=\"Total Socios\"\r\n            kpiValue={data.memberCount}\r\n            link=\"/reports/members\"\r\n          >\r\n            <div className=\"flex items-center gap-2 mt-2\">\r\n              <div className=\"h-px bg-[#506385] flex-grow opacity-30\"></div>\r\n              <div className=\"text-[10px] uppercase tracking-wider opacity-50\">Base de Datos</div>\r\n            </div>\r\n          </ViewCard>\r\n\r\n        </div>\r\n      </div>\r\n    </main>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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"}}]
}