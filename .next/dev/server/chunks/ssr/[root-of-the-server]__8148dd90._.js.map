{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 20, "column": 0}, "map": {"version":3,"sources":["file:///app/src/lib/db.ts"],"sourcesContent":["import { Pool } from 'pg';\r\n\r\nconst pool = new Pool({\r\n    host: process.env.DB_HOST || 'localhost',\r\n    port: parseInt(process.env.DB_PORT || '5434'),\r\n    user: process.env.DB_USER || 'biblioteca_admin',\r\n    password: process.env.DB_PASSWORD,\r\n    database: process.env.DB_NAME || 'biblioteca',\r\n});\r\n\r\nexport default pool;\r\n"],"names":[],"mappings":";;;;AAAA;;;;;;AAEA,MAAM,OAAO,IAAI,qJAAI,CAAC;IAClB,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,MAAM,SAAS,QAAQ,GAAG,CAAC,OAAO,IAAI;IACtC,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,UAAU,QAAQ,GAAG,CAAC,WAAW;IACjC,UAAU,QAAQ,GAAG,CAAC,OAAO,IAAI;AACrC;uCAEe"}},
    {"offset": {"line": 45, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/reports/multas/page.tsx"],"sourcesContent":["  import Link from 'next/link';\r\nimport pool from '@/lib/db';\r\n\r\ninterface Multa {\r\n  mes: string;\r\n  cantidad_multas: string;\r\n  total_cobrado: string;\r\n  deuda_pendiente: string;\r\n  total_multas: string;\r\n}\r\n\r\nasync function obtenerDatosMultas(start?: string, end?: string) {\r\n  const client = await pool.connect();\r\n  try {\r\n    let query = 'SELECT * FROM vw_resumen_multas';\r\n    const params: string[] = [];\r\n\r\n    if (start && end) {\r\n      query += ' WHERE mes >= $1 AND mes <= $2';\r\n      params.push(start, end);\r\n    }\r\n\r\n    query += ' ORDER BY mes DESC LIMIT 12';\r\n\r\n    const result = await client.query(query, params);\r\n    return result.rows as Multa[];\r\n  } finally {\r\n    client.release();\r\n  }\r\n}\r\n\r\nexport default async function PaginaMultas({\r\n  searchParams,\r\n}: {\r\n  searchParams: Promise<{ start?: string; end?: string }>;\r\n}) {\r\n  const params = await searchParams;\r\n  const datos = await obtenerDatosMultas(params.start, params.end);\r\n\r\n  // Calcular totales\r\n  let totalCobrado = 0;\r\n  let totalDeuda = 0;\r\n\r\n  datos.forEach(d => {\r\n    totalCobrado += parseFloat(d.total_cobrado);\r\n    totalDeuda += parseFloat(d.deuda_pendiente);\r\n  });\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <div className=\"header\">\r\n        <Link href=\"/\" className=\"back-link\">‚Üê Volver al Dashboard</Link>\r\n        <h1>Reporte de Multas</h1>\r\n        <p>Resumen financiero de multas cobradas y pendientes</p>\r\n      </div>\r\n\r\n      {/* Filtros */}\r\n      <form className=\"filters\">\r\n        <div className=\"filter-group\">\r\n          <label>Desde:</label>\r\n          <input\r\n            type=\"month\"\r\n            name=\"start\"\r\n            defaultValue={params.start || ''}\r\n          />\r\n        </div>\r\n        <div className=\"filter-group\">\r\n          <label>Hasta:</label>\r\n          <input\r\n            type=\"month\"\r\n            name=\"end\"\r\n            defaultValue={params.end || ''}\r\n          />\r\n        </div>\r\n        <button type=\"submit\" className=\"btn\">Filtrar</button>\r\n        {(params.start || params.end) && (\r\n          <Link href=\"/reports/multas\" className=\"btn-secondary\">Limpiar</Link>\r\n        )}\r\n      </form>\r\n\r\n      {/* KPIs */}\r\n      <div className=\"kpi-grid\">\r\n        <div className=\"kpi-card green\">\r\n          <h3>Total Cobrado</h3>\r\n          <p className=\"kpi-value\">${totalCobrado.toFixed(2)}</p>\r\n        </div>\r\n        <div className=\"kpi-card red\">\r\n          <h3>Deuda Pendiente</h3>\r\n          <p className=\"kpi-value\">${totalDeuda.toFixed(2)}</p>\r\n        </div>\r\n        <div className=\"kpi-card blue\">\r\n          <h3>Efectividad</h3>\r\n          <p className=\"kpi-value\">\r\n            {totalCobrado + totalDeuda > 0\r\n              ? ((totalCobrado / (totalCobrado + totalDeuda)) * 100).toFixed(1)\r\n              : 0}%\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tabla */}\r\n      <div className=\"table-container\">\r\n        <h2>Desglose Mensual</h2>\r\n        <table>\r\n          <thead>\r\n            <tr>\r\n              <th>Mes</th>\r\n              <th>Cantidad</th>\r\n              <th>Cobrado</th>\r\n              <th>Pendiente</th>\r\n              <th>Total</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {datos.map(row => (\r\n              <tr key={row.mes}>\r\n                <td><strong>{row.mes}</strong></td>\r\n                <td>{row.cantidad_multas}</td>\r\n                <td className=\"green\">${parseFloat(row.total_cobrado).toFixed(2)}</td>\r\n                <td className=\"red\">${parseFloat(row.deuda_pendiente).toFixed(2)}</td>\r\n                <td><strong>${parseFloat(row.total_multas).toFixed(2)}</strong></td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n        {datos.length === 0 && <p className=\"no-data\">No hay datos disponibles</p>}\r\n      </div>\r\n\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}}]
}